

# LangChain 提示词模块应用指南 - 运行指导文档

## 概述
本文档提供《LangChain 提示词模块应用指南》博客文章的完整运行指导，包含环境准备、代码运行步骤和常见问题解决方案。

## 环境准备

### 1. Python 环境
- Python 3.8 或更高版本
- 推荐使用虚拟环境

### 2. 依赖安装
```bash
# 创建虚拟环境（可选）
python -m venv langchain-env
source langchain-env/bin/activate  # Linux/Mac
# 或 langchain-env\Scripts\activate  # Windows

# 安装依赖包
pip install langchain langchain-openai python-dotenv
```

### 3. API 密钥配置
创建 `.env` 文件并添加 OpenAI API 密钥：
```bash
OPENAI_API_KEY=your_openai_api_key_here
```

## 快速运行

### 基础模板示例
```bash
# 运行基础模板示例
python 02-prompt-templates/basic_template.py
```

### Few-shot 提示词示例
```bash
# 运行 Few-shot 提示词示例
python 02-prompt-templates/few_shot_template.py
```

### 聊天模板示例
```bash
# 运行聊天模板示例
python 02-prompt-templates/chat_template.py
```

### JSON 输出示例
```bash
# 运行 JSON 输出示例
python 02-prompt-templates/json_output.py
```

### Pydantic 输出示例
```bash
# 运行 Pydantic 输出示例
python 02-prompt-templates/pydantic_output.py
```

## 详细运行步骤

### 步骤 1：环境验证
```bash
# 验证 Python 版本
python --version

# 验证依赖安装
python -c "import langchain; print('LangChain 安装成功')"
```

### 步骤 2：配置 API 密钥
1. 在项目根目录创建 `.env` 文件
2. 添加 OpenAI API 密钥
3. 确保 `.env` 文件在 `.gitignore` 中

### 步骤 3：运行示例代码
按照上述快速运行部分执行对应的 Python 文件

## 代码结构说明

### 主要文件
- `basic_template.py` - 基础模板示例
- `few_shot_template.py` - Few-shot 提示词示例
- `chat_template.py` - 聊天模板示例
- `json_output.py` - JSON 输出示例
- `pydantic_output.py` - Pydantic 输出示例

### 核心功能
1. **基础模板**：变量插值、模板格式化
2. **Few-shot 提示词**：示例学习、风格控制
3. **聊天模板**：系统消息、用户消息、助手消息
4. **输出控制**：JSON 格式、Pydantic 模型约束

## 常见问题

### Q1: 模块导入错误
**问题**：`ModuleNotFoundError: No module named 'langchain'`
**解决方案**：重新安装依赖包
```bash
pip install -r requirements.txt
```

### Q2: API 密钥错误
**问题**：`AuthenticationError: Invalid API key`
**解决方案**：检查 `.env` 文件中的 API 密钥是否正确

### Q3: 输出格式错误
**问题**：JSON 解析失败
**解决方案**：检查输出解析器配置，确保模型输出符合预期格式

### Q4: 网络连接问题
**问题**：连接超时或网络错误
**解决方案**：检查网络连接，或使用代理配置

## 调试技巧

### 1. 启用调试模式
```python
import os
os.environ["LANGCHAIN_VERBOSE"] = "true"
```

### 2. 查看中间结果
```python
# 在关键步骤添加打印语句
print("提示词内容:", prompt)
print("模型响应:", response)
```

### 3. 使用本地模型（可选）
如需使用本地模型，可配置其他模型提供商如 Ollama、Hugging Face 等。

## 性能优化建议

1. **批量处理**：对于多个相似任务，使用批量处理
2. **缓存结果**：对重复查询使用缓存机制
3. **模板复用**：合理设计模板结构，提高复用性
4. **错误处理**：添加适当的异常处理和重试机制

## 扩展开发

### 自定义模板
参考现有模板结构，创建符合特定业务需求的模板

### 集成其他工具
可集成向量数据库、外部 API 等扩展功能

### 部署建议
- 生产环境使用环境变量管理敏感信息
- 添加监控和日志记录
- 考虑限流和错误恢复机制

---

**注意**：运行前请确保已正确配置 API 密钥和依赖环境。如有问题，请参考常见问题部分或查看相关文档。


